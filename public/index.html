<!DOCTYPE html>
<!--
// Licensed under the Apache License. See footer for details.
-->
<html ng-app="app" lang="en">

<head>
  <title>Elephant Carpaccio - a Nano-incremental development exercise</title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="google" content="notranslate" />

  <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.1.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="vendor/bootstrap/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="css/app.css">
</head>

<body ng-controller="AppController" ng-cloak>  
  <div class="intro">
    What is this all about? <a href="https://github.com/l2fprod/carpaccio-store">Find out more...</a>
  </div>
  
  <div class="title-container">
    <span class="title">Elephant Carpaccio</span>
  </div>

  <div class="cart-container container">
    <div class="row cart-section products">
      <div class="col-md-2 cart-section-title">Enjoy our best products</div>
      <div class="col-md-10">
        <div class="product well" ng-repeat="product in data.products">
          <div>
            <label>
              {{product.name}}
              <br/>
              <img class="product-image" ng-src="{{product.image}}" />
              <br/>
              <input type="radio" ng-model="data.cart.product" name="product" ng-value="product">
            </label>
          </div>
          <div>${{product.price}}</div>
        </div>
      </div>
    </div>

    <div class="row cart-section">
      <div class="col-md-2 cart-section-title">How many of this juicy breed?</div>
      <div class="col-md-8">
        <form>
          <input class="form-control quantity" type="number" min="1" id="quantity" value="1" ng-model="data.cart.quantity">
        </form>
      </div>
    </div>

    <div class="row cart-section">
      <div class="col-md-2 cart-section-title">Where should we ship?</div>
      <div class="col-md-8">
        <select class="form-control state" ng-model="data.cart.state">
          <option value="UT">Utah (UT)</option>
        </select>
      </div>
    </div>

    <div class="row raw-price-section">
      <div class="col-md-2 cart-section-title">Price before taxes</div>
      <div class="col-md-8 raw-price">
        ${{priceBeforeTaxes()}}
      </div>
    </div>

    <div class="row actual-price-section">
      <div class="col-md-2 cart-section-title">
        Price with taxes
        <button class="btn btn-sm btn-info" data-toggle="modal" data-target="#registerPricerDialog">Register a pricing engine</button>
      </div>
      <div class="col-md-8 raw-price">
        <button class="btn btn-lg btn-success" ng-click="computePrices()">Compute Total Price</button>

        <div class="alert alert-danger" ng-if="data.pricingEngines.length == 0">
          No pricing engine found - we can't sell :(
        </div>
        <div ng-repeat="engine in data.pricingEngines">
          {{engine.name}} - 
          <span ng-if="data.cart.prices[engine.id].totalPrice != null">${{data.cart.prices[engine.id].totalPrice}}</span>
          <span ng-if="data.cart.prices[engine.id].totalPrice == null">{{data.cart.prices[engine.id]}}</span>
        </div>
      </div>
    </div>

  </div>

  <footer>
    made by <a href="https://github.com/frawa">frank</a> and <a href="https://twitter.com/l2fprod">fred</a>
  </footer>

  <div id="registerPricerDialog" class="modal fade">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <h4 class="modal-title">Register a Pricing Engine</h4>
        </div>
        <div class="modal-body">
          <form>
            <div class="form-group">
              <label>Name*</label>
              <input class="form-control" type="text" name="name" ng-model="data.registerPricer.name" required/>
            </div>
            <div class="form-group">
              <label>Endpoint*</label>
              <input class="form-control" type="text" name="endpoint" ng-model="data.registerPricer.endpoint" placeholder="https://myhost.mydomain.com/pricing/" required>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          <button type="submit" class="btn btn-primary" ng-click="registerPricingEngine()">Register</button>
        </div>
      </div>
      <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
  </div>
  <!-- /.modal -->

  <script src="vendor/angular/angular.min.js"></script>
  <script src="vendor/jquery/dist/jquery.min.js"></script>
  <script src="vendor/bootstrap/dist/js/bootstrap.min.js"></script>
  <script src="js/app.js"></script>
</body>
<!--
//------------------------------------------------------------------------------
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//    http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
//------------------------------------------------------------------------------
-->
